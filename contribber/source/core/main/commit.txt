Improved error handling for better reliability
Added missing error handling for better stability
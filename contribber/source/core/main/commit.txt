Fixed memory leak causing performance issues
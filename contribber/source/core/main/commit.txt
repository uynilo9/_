Added missing input validation for better security
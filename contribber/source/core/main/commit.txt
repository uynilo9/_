Improved performance by optimizing algorithm
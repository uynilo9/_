Refactored code to improve efficiency and readability
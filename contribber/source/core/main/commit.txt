Improved security by adding input validation